<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-4193">
<link rel="alternate" type="application/rss+xml" href="/autogen/blog/rss.xml" title="AutoGen RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/autogen/blog/atom.xml" title="AutoGen Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Frequently Asked Questions | AutoGen</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io/autogen/docs/FAQ"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Frequently Asked Questions | AutoGen"><meta data-react-helmet="true" name="description" content="Set your API endpoints"><meta data-react-helmet="true" property="og:description" content="Set your API endpoints"><link data-react-helmet="true" rel="shortcut icon" href="/autogen/img/ag.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io/autogen/docs/FAQ"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/autogen/docs/FAQ" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io/autogen/docs/FAQ" hreflang="x-default"><link rel="stylesheet" href="/autogen/assets/css/styles.d208c800.css">
<link rel="preload" href="/autogen/assets/js/runtime~main.38db2ed9.js" as="script">
<link rel="preload" href="/autogen/assets/js/main.f17a7871.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/autogen/"><div class="navbar__logo"><img src="/autogen/img/ag.svg" alt="AutoGen" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/autogen/img/ag.svg" alt="AutoGen" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">AutoGen</b></a><a class="navbar__item navbar__link" href="/autogen/docs/Getting-Started">Docs</a><a class="navbar__item navbar__link" href="/autogen/docs/reference/agentchat/conversable_agent">SDK</a><a class="navbar__item navbar__link" href="/autogen/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/autogen/docs/FAQ">FAQ</a><a class="navbar__item navbar__link" href="/autogen/docs/Examples">Examples</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link">Resources</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/autogen/docs/Ecosystem">Ecosystem</a></li><li><a class="dropdown__link" href="/autogen/docs/Gallery">Gallery</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/autogen" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Frequently Asked Questions</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="set-your-api-endpoints">Set your API endpoints<a aria-hidden="true" class="hash-link" href="#set-your-api-endpoints" title="Direct link to heading">â€‹</a></h2><p>There are multiple ways to construct configurations for LLM inference in the <code>oai</code> utilities:</p><ul><li><code>get_config_list</code>: Generates configurations for API calls, primarily from provided API keys.</li><li><code>config_list_openai_aoai</code>: Constructs a list of configurations using both Azure OpenAI and OpenAI endpoints, sourcing API keys from environment variables or local files.</li><li><code>config_list_from_json</code>: Loads configurations from a JSON structure, either from an environment variable or a local JSON file, with the flexibility of filtering configurations based on given criteria.</li><li><code>config_list_from_models</code>: Creates configurations based on a provided list of models, useful when targeting specific models without manually specifying each configuration.</li><li><code>config_list_from_dotenv</code>: Constructs a configuration list from a <code>.env</code> file, offering a consolidated way to manage multiple API configurations and keys from a single file.</li></ul><p>We suggest that you take a look at this <a href="https://github.com/microsoft/autogen/blob/main/notebook/oai_openai_utils.ipynb" target="_blank" rel="noopener noreferrer">notebook</a> for full code examples of the different methods to configure your model endpoints.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="use-the-constructed-configuration-list-in-agents">Use the constructed configuration list in agents<a aria-hidden="true" class="hash-link" href="#use-the-constructed-configuration-list-in-agents" title="Direct link to heading">â€‹</a></h3><p>Make sure the &quot;config_list&quot; is included in the <code>llm_config</code> in the constructor of the LLM-based agent. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">AssistantAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;assistant&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    llm_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;config_list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>llm_config</code> is used in the <a href="/autogen/docs/reference/oai/client#create"><code>create</code></a> function for LLM inference.
When <code>llm_config</code> is not provided, the agent will rely on other openai settings such as <code>openai.api_key</code> or the environment variable <code>OPENAI_API_KEY</code>, which can also work when you&#x27;d like to use a single endpoint.
You can also explicitly specify that by:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">AssistantAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;assistant&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> llm_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;api_key&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="unexpected-keyword-argument-base_url">Unexpected keyword argument &#x27;base_url&#x27;<a aria-hidden="true" class="hash-link" href="#unexpected-keyword-argument-base_url" title="Direct link to heading">â€‹</a></h3><p>In version &gt;=1, OpenAI renamed their <code>api_base</code> parameter to <code>base_url</code>. So for older versions, use <code>api_base</code> but for newer versions use <code>base_url</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="can-i-use-non-openai-models">Can I use non-OpenAI models?<a aria-hidden="true" class="hash-link" href="#can-i-use-non-openai-models" title="Direct link to heading">â€‹</a></h3><p>Yes. Please check <a href="https://microsoft.github.io/autogen/blog/2023/07/14/Local-LLMs" target="_blank" rel="noopener noreferrer">https://microsoft.github.io/autogen/blog/2023/07/14/Local-LLMs</a> for an example.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="handle-rate-limit-error-and-timeout-error">Handle Rate Limit Error and Timeout Error<a aria-hidden="true" class="hash-link" href="#handle-rate-limit-error-and-timeout-error" title="Direct link to heading">â€‹</a></h2><p>You can set <code>max_retries</code> to handle rate limit error. And you can set <code>timeout</code> to handle timeout error. They can all be specified in <code>llm_config</code> for an agent, which will be used in the OpenAI client for LLM inference. They can be set differently for different clients if they are set in the <code>config_list</code>.</p><ul><li><code>max_retries</code> (int): the total number of times allowed for retrying failed requests for a single client.</li><li><code>timeout</code> (int): the timeout (in seconds) for a single client.</li></ul><p>Please refer to the <a href="/autogen/docs/Use-Cases/enhanced_inference#runtime-error">documentation</a> for more info.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-continue-a-finished-conversation">How to continue a finished conversation<a aria-hidden="true" class="hash-link" href="#how-to-continue-a-finished-conversation" title="Direct link to heading">â€‹</a></h2><p>When you call <code>initiate_chat</code> the conversation restarts by default. You can use <code>send</code> or <code>initiate_chat(clear_history=False)</code> to continue the conversation.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-do-we-decide-what-llm-is-used-for-each-agent-how-many-agents-can-be-used-how-do-we-decide-how-many-agents-in-the-group">How do we decide what LLM is used for each agent? How many agents can be used? How do we decide how many agents in the group?<a aria-hidden="true" class="hash-link" href="#how-do-we-decide-what-llm-is-used-for-each-agent-how-many-agents-can-be-used-how-do-we-decide-how-many-agents-in-the-group" title="Direct link to heading">â€‹</a></h2><p>Each agent can be customized. You can use LLMs, tools, or humans behind each agent. If you use an LLM for an agent, use the one best suited for its role. There is no limit of the number of agents, but start from a small number like 2, 3. The more capable is the LLM and the fewer roles you need, the fewer agents you need.</p><p>The default user proxy agent doesn&#x27;t use LLM. If you&#x27;d like to use an LLM in UserProxyAgent, the use case could be to simulate user&#x27;s behavior.</p><p>The default assistant agent is instructed to use both coding and language skills. It doesn&#x27;t have to do coding, depending on the tasks. And you can customize the system message. So if you want to use it for coding, use a model that&#x27;s good at coding.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="why-is-code-not-saved-as-file">Why is code not saved as file?<a aria-hidden="true" class="hash-link" href="#why-is-code-not-saved-as-file" title="Direct link to heading">â€‹</a></h2><p>If you are using a custom system message for the coding agent, please include something like:
<code>If you want the user to save the code in a file before executing it, put # filename: &lt;filename&gt; inside the code block as the first line.</code>
in the system message. This line is in the default system message of the <code>AssistantAgent</code>.</p><p>If the <code># filename</code> doesn&#x27;t appear in the suggested code still, consider adding explicit instructions such as &quot;save the code to disk&quot; in the initial user message in <code>initiate_chat</code>.
The <code>AssistantAgent</code> doesn&#x27;t save all the code by default, because there are cases in which one would just like to finish a task without saving the code.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="code-execution">Code execution<a aria-hidden="true" class="hash-link" href="#code-execution" title="Direct link to heading">â€‹</a></h2><p>We strongly recommend using docker to execute code. There are two ways to use docker:</p><ol><li>Run autogen in a docker container. For example, when developing in GitHub codespace, the autogen runs in a docker container.</li><li>Run autogen outside of a docker, while perform code execution with a docker container. For this option, make sure the python package <code>docker</code> is installed. When it is not installed and <code>use_docker</code> is omitted in <code>code_execution_config</code>, the code will be executed locally (this behavior is subject to change in future).</li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="enable-python-3-docker-image">Enable Python 3 docker image<a aria-hidden="true" class="hash-link" href="#enable-python-3-docker-image" title="Direct link to heading">â€‹</a></h3><p>You might want to override the default docker image used for code execution. To do that set <code>use_docker</code> key of <code>code_execution_config</code> property to the name of the image. E.g.:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">user_proxy </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">UserProxyAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;agent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    human_input_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;TERMINATE&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    max_consecutive_auto_reply</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    code_execution_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;work_dir&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;_output&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;use_docker&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;python:3&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    llm_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">llm_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    system_message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;&quot;Reply TERMINATE if the task has been solved at full satisfaction.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Otherwise, reply CONTINUE, or the reason why the task is not solved yet.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you have problems with agents running <code>pip install</code> or get errors similar to <code>Error while fetching server API version: (&#x27;Connection aborted.&#x27;, FileNotFoundError(2, &#x27;No such file or directory&#x27;)</code>, you can choose <strong>&#x27;python:3&#x27;</strong> as image as shown in the code example above and that should solve the problem.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="agents-keep-thanking-each-other-when-using-gpt-35-turbo">Agents keep thanking each other when using <code>gpt-3.5-turbo</code><a aria-hidden="true" class="hash-link" href="#agents-keep-thanking-each-other-when-using-gpt-35-turbo" title="Direct link to heading">â€‹</a></h3><p>When using <code>gpt-3.5-turbo</code> you may often encounter agents going into a &quot;gratitude loop&quot;, meaning when they complete a task they will begin congratulating and thanking eachother in a continuous loop. This is a limitation in the performance of <code>gpt-3.5-turbo</code>, in contrast to <code>gpt-4</code> which has no problem remembering instructions. This can hinder the experimentation experience when trying to test out your own use case with cheaper models.</p><p>A workaround is to add an additional termination notice to the prompt. This acts a &quot;little nudge&quot; for the LLM to remember that they need to terminate the conversation when their task is complete. You can do this by appending a string such as the following to your user input string:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">prompt </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Some user query&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">termination_notice </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;\n\nDo not show appreciation in your responses, say only what is necessary. &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;if &quot;Thank you&quot; or &quot;You\&#x27;re welcome&quot; are said in the conversation, then say TERMINATE &#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;to indicate the conversation is finished and this is your last message.&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">prompt </span><span class="token operator" style="color:rgb(137, 221, 255)">+=</span><span class="token plain"> termination_notice</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Note</strong>: This workaround gets the job done around 90% of the time, but there are occurrences where the LLM still forgets to terminate the conversation.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="chromadb-fails-in-codespaces-because-of-old-version-of-sqlite3">ChromaDB fails in codespaces because of old version of sqlite3<a aria-hidden="true" class="hash-link" href="#chromadb-fails-in-codespaces-because-of-old-version-of-sqlite3" title="Direct link to heading">â€‹</a></h2><p>(from <a href="https://github.com/microsoft/autogen/issues/251" target="_blank" rel="noopener noreferrer">issue #251</a>)</p><p>Code examples that use chromadb (like retrieval) fail in codespaces due to a sqlite3 requirement.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">&gt;&gt;&gt; import chromadb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Traceback (most recent call last):</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  File &quot;/home/vscode/.local/lib/python3.10/site-packages/chromadb/__init__.py&quot;, line 69, in &lt;module&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    raise RuntimeError(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RuntimeError: Your system has an unsupported version of sqlite3. Chroma requires sqlite3 &gt;= 3.35.0.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please visit https://docs.trychroma.com/troubleshooting#sqlite to learn how to upgrade.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Workaround:</p><ol><li><code>pip install pysqlite3-binary</code></li><li><code>mkdir /home/vscode/.local/lib/python3.10/site-packages/google/colab</code></li></ol><p>Explanation: Per <a href="https://gist.github.com/defulmere/8b9695e415a44271061cc8e272f3c300?permalink_comment_id=4711478#gistcomment-4711478" target="_blank" rel="noopener noreferrer">this gist</a>, linked from the official <a href="https://docs.trychroma.com/troubleshooting#sqlite" target="_blank" rel="noopener noreferrer">chromadb docs</a>, adding this folder triggers chromadb to use pysqlite3 instead of the default.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-register-a-reply-function">How to register a reply function<a aria-hidden="true" class="hash-link" href="#how-to-register-a-reply-function" title="Direct link to heading">â€‹</a></h2><p>(from <a href="https://github.com/microsoft/autogen/issues/478" target="_blank" rel="noopener noreferrer">issue #478</a>)</p><p>See here <a href="https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent/#register_reply" target="_blank" rel="noopener noreferrer">https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent/#register_reply</a></p><p> For example, you can register a reply function that gets called when <code>generate_reply</code> is called for an agent.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">print_messages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> messages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;callback&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> config </span><span class="token keyword" style="font-style:italic">and</span><span class="token plain">  config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;callback&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">is</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">not</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        callback </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;callback&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        callback</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">sender</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> recipient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> messages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;Messages sent to: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">recipient</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token string-interpolation interpolation">name</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)"> | num messages: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation builtin" style="color:rgb(130, 170, 255)">len</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation interpolation">messages</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># required to ensure the agent communication flow continues</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user_proxy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">register_reply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Agent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reply_func</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">print_messages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;callback&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">register_reply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Agent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    reply_func</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">print_messages</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;callback&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the above, we register a <code>print_messages</code> function that is called each time the agent&#x27;s <code>generate_reply</code> is triggered after receiving a message.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-get-last-message-">How to get last message ?<a aria-hidden="true" class="hash-link" href="#how-to-get-last-message-" title="Direct link to heading">â€‹</a></h2><p>Refer to <a href="https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent/#last_message" target="_blank" rel="noopener noreferrer">https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent/#last_message</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-get-each-agent-message-">How to get each agent message ?<a aria-hidden="true" class="hash-link" href="#how-to-get-each-agent-message-" title="Direct link to heading">â€‹</a></h2><p>Please refer to <a href="https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent#chat_messages" target="_blank" rel="noopener noreferrer">https://microsoft.github.io/autogen/docs/reference/agentchat/conversable_agent#chat_messages</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/autogen/edit/main/website/docs/FAQ.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#set-your-api-endpoints" class="table-of-contents__link toc-highlight">Set your API endpoints</a><ul><li><a href="#use-the-constructed-configuration-list-in-agents" class="table-of-contents__link toc-highlight">Use the constructed configuration list in agents</a></li><li><a href="#unexpected-keyword-argument-base_url" class="table-of-contents__link toc-highlight">Unexpected keyword argument &#39;base_url&#39;</a></li><li><a href="#can-i-use-non-openai-models" class="table-of-contents__link toc-highlight">Can I use non-OpenAI models?</a></li></ul></li><li><a href="#handle-rate-limit-error-and-timeout-error" class="table-of-contents__link toc-highlight">Handle Rate Limit Error and Timeout Error</a></li><li><a href="#how-to-continue-a-finished-conversation" class="table-of-contents__link toc-highlight">How to continue a finished conversation</a></li><li><a href="#how-do-we-decide-what-llm-is-used-for-each-agent-how-many-agents-can-be-used-how-do-we-decide-how-many-agents-in-the-group" class="table-of-contents__link toc-highlight">How do we decide what LLM is used for each agent? How many agents can be used? How do we decide how many agents in the group?</a></li><li><a href="#why-is-code-not-saved-as-file" class="table-of-contents__link toc-highlight">Why is code not saved as file?</a></li><li><a href="#code-execution" class="table-of-contents__link toc-highlight">Code execution</a><ul><li><a href="#enable-python-3-docker-image" class="table-of-contents__link toc-highlight">Enable Python 3 docker image</a></li><li><a href="#agents-keep-thanking-each-other-when-using-gpt-35-turbo" class="table-of-contents__link toc-highlight">Agents keep thanking each other when using <code>gpt-3.5-turbo</code></a></li></ul></li><li><a href="#chromadb-fails-in-codespaces-because-of-old-version-of-sqlite3" class="table-of-contents__link toc-highlight">ChromaDB fails in codespaces because of old version of sqlite3</a></li><li><a href="#how-to-register-a-reply-function" class="table-of-contents__link toc-highlight">How to register a reply function</a></li><li><a href="#how-to-get-last-message-" class="table-of-contents__link toc-highlight">How to get last message ?</a></li><li><a href="#how-to-get-each-agent-message-" class="table-of-contents__link toc-highlight">How to get each agent message ?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/pAbnFJrkgZ" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/pyautogen" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 AutoGen Authors.</div></div></div></footer></div>
<script src="/autogen/assets/js/runtime~main.38db2ed9.js"></script>
<script src="/autogen/assets/js/main.f17a7871.js"></script>
</body>
</html>